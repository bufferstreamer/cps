<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="include :: header('一键通知')"/>
    <th:block th:include="include :: datetimepicker-css"/>
    <th:block th:include="include :: bootstrap-fileinput-css"/>
</head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <form class="form-horizontal m" id="form-tender1-inform">
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">通知方式：</label>
            <div class="col-sm-8">
                <select class="form-control" name="informWay" >
                    <option selected value="1">邮件通知</option>
                    <option value="2">短信通知</option>
                    <option value="3">全选</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">通知标题：</label>
            <div class="col-sm-8">
                <textarea name="informSubject" rows="1" class="form-control" required></textarea>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">通知内容：</label>
            <div class="col-sm-8">
                <textarea name="informContent" rows="8" class="form-control" required></textarea>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label is-required">经营范围：</label>
            <div class="col-sm-8">
                <div class="col-sm-9" id="businessScope">
                    <label class="check-box">
                        <input type="checkbox" value="option1"  name="deptId">选项1</label>
                    <label class="check-box">
                        <input type="checkbox" value="option2"  name="deptId">选项2</label>
                    <label class="check-box">
                        <input type="checkbox" value="option3"  name="deptId">选项3</label>
                </div>
            </div>
        </div>
    </form>
</div>
<th:block th:include="include :: footer"/>
<th:block th:include="include :: datetimepicker-js"/>
<th:block th:include="include :: bootstrap-fileinput-js"/>
<script th:inline="javascript">
    var prefix = ctx + "cp/tender1";
    var deptPrefix = ctx + "system/dept"
    $("#form-tender1-inform").validate({
        focusCleanup: true
    });

    function submitHandler() {
         if ($.validate.form()) {
             $.operate.post(prefix + "/noticeByEmail",$('#form-tender1-inform').serialize());
         }
         $.modal.close();
    }

    $(function () {
        $.ajax({
            url:deptPrefix + "/list",
            dataType:"json",
            success:function (resp) {
                $("#businessScope").empty();
                $.each(resp,function (i,n) {
                    $("#businessScope").append('<label class="check-box"> <input type="checkbox" value="'+ n.deptId + '"name="deptId">' + n.deptName + '</label>');
                });
                $(".check-box:first").remove()
            },
            type:"post"
        })
    });
</script>
</body>
</html>